{{- if not .Values.existingSecret }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "picoclaw.fullname" . }}
  labels:
    {{- include "picoclaw.labels" . | nindent 4 }}
type: Opaque
data:
  {{- /* Provider API Keys */ -}}
  {{- if and .Values.providers .Values.providers.openrouter .Values.providers.openrouter.apiKey }}
  OPENROUTER_API_KEY: {{ .Values.providers.openrouter.apiKey | b64enc | quote }}
  {{- else }}
  OPENROUTER_API_KEY: ""
  {{- end }}
  {{- if and .Values.providers .Values.providers.zhipu .Values.providers.zhipu.apiKey }}
  ZHIPU_API_KEY: {{ .Values.providers.zhipu.apiKey | b64enc | quote }}
  {{- else }}
  ZHIPU_API_KEY: ""
  {{- end }}
  {{- if and .Values.providers .Values.providers.anthropic .Values.providers.anthropic.apiKey }}
  ANTHROPIC_API_KEY: {{ .Values.providers.anthropic.apiKey | b64enc | quote }}
  {{- else }}
  ANTHROPIC_API_KEY: ""
  {{- end }}
  {{- if and .Values.providers .Values.providers.openai .Values.providers.openai.apiKey }}
  OPENAI_API_KEY: {{ .Values.providers.openai.apiKey | b64enc | quote }}
  {{- else }}
  OPENAI_API_KEY: ""
  {{- end }}
  {{- if and .Values.providers .Values.providers.gemini .Values.providers.gemini.apiKey }}
  GEMINI_API_KEY: {{ .Values.providers.gemini.apiKey | b64enc | quote }}
  {{- else }}
  GEMINI_API_KEY: ""
  {{- end }}
  {{- if and .Values.providers .Values.providers.groq .Values.providers.groq.apiKey }}
  GROQ_API_KEY: {{ .Values.providers.groq.apiKey | b64enc | quote }}
  {{- else }}
  GROQ_API_KEY: ""
  {{- end }}
  
  {{- /* Tools API Keys */ -}}
  {{- if and .Values.tools .Values.tools.web .Values.tools.web.brave .Values.tools.web.brave.apiKey }}
  BRAVE_API_KEY: {{ .Values.tools.web.brave.apiKey | b64enc | quote }}
  {{- else }}
  BRAVE_API_KEY: ""
  {{- end }}
  
  {{- /* Telegram */ -}}
  {{- if and .Values.channels .Values.channels.telegram .Values.channels.telegram.token }}
  TELEGRAM_BOT_TOKEN: {{ .Values.channels.telegram.token | b64enc | quote }}
  {{- else }}
  TELEGRAM_BOT_TOKEN: ""
  {{- end }}
  
  {{- /* Discord */ -}}
  {{- if and .Values.channels .Values.channels.discord .Values.channels.discord.token }}
  DISCORD_BOT_TOKEN: {{ .Values.channels.discord.token | b64enc | quote }}
  {{- else }}
  DISCORD_BOT_TOKEN: ""
  {{- end }}
  
  {{- /* QQ */ -}}
  {{- if and .Values.channels .Values.channels.qq .Values.channels.qq.appId }}
  QQ_APP_ID: {{ .Values.channels.qq.appId | b64enc | quote }}
  {{- else }}
  QQ_APP_ID: ""
  {{- end }}
  {{- if and .Values.channels .Values.channels.qq .Values.channels.qq.appSecret }}
  QQ_APP_SECRET: {{ .Values.channels.qq.appSecret | b64enc | quote }}
  {{- else }}
  QQ_APP_SECRET: ""
  {{- end }}
  
  {{- /* DingTalk */ -}}
  {{- if and .Values.channels .Values.channels.dingtalk .Values.channels.dingtalk.clientId }}
  DINGTALK_CLIENT_ID: {{ .Values.channels.dingtalk.clientId | b64enc | quote }}
  {{- else }}
  DINGTALK_CLIENT_ID: ""
  {{- end }}
  {{- if and .Values.channels .Values.channels.dingtalk .Values.channels.dingtalk.clientSecret }}
  DINGTALK_CLIENT_SECRET: {{ .Values.channels.dingtalk.clientSecret | b64enc | quote }}
  {{- else }}
  DINGTALK_CLIENT_SECRET: ""
  {{- end }}
  
  {{- /* LINE */ -}}
  {{- if and .Values.channels .Values.channels.line .Values.channels.line.channelSecret }}
  LINE_CHANNEL_SECRET: {{ .Values.channels.line.channelSecret | b64enc | quote }}
  {{- else }}
  LINE_CHANNEL_SECRET: ""
  {{- end }}
  {{- if and .Values.channels .Values.channels.line .Values.channels.line.channelAccessToken }}
  LINE_CHANNEL_ACCESS_TOKEN: {{ .Values.channels.line.channelAccessToken | b64enc | quote }}
  {{- else }}
  LINE_CHANNEL_ACCESS_TOKEN: ""
  {{- end }}
{{- end }}
