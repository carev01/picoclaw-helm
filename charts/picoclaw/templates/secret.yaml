{{- if not .Values.existingSecret }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "picoclaw.fullname" . }}
  labels:
    {{- include "picoclaw.labels" . | nindent 4 }}
type: Opaque
data:
  {{- /* Providers - must use PICOCLAW_PROVIDERS_<NAME>_API_KEY format */ -}}
  {{- if and .Values.providers .Values.providers.openrouter .Values.providers.openrouter.apiKey }}
  PICOCLAW_PROVIDERS_OPENROUTER_API_KEY: {{ .Values.providers.openrouter.apiKey | b64enc | quote }}
  {{- else }}
  PICOCLAW_PROVIDERS_OPENROUTER_API_KEY: ""
  {{- end }}
  {{- if and .Values.providers .Values.providers.zhipu .Values.providers.zhipu.apiKey }}
  PICOCLAW_PROVIDERS_ZHIPU_API_KEY: {{ .Values.providers.zhipu.apiKey | b64enc | quote }}
  {{- else }}
  PICOCLAW_PROVIDERS_ZHIPU_API_KEY: ""
  {{- end }}
  {{- if and .Values.providers .Values.providers.anthropic .Values.providers.anthropic.apiKey }}
  PICOCLAW_PROVIDERS_ANTHROPIC_API_KEY: {{ .Values.providers.anthropic.apiKey | b64enc | quote }}
  {{- else }}
  PICOCLAW_PROVIDERS_ANTHROPIC_API_KEY: ""
  {{- end }}
  {{- if and .Values.providers .Values.providers.openai .Values.providers.openai.apiKey }}
  PICOCLAW_PROVIDERS_OPENAI_API_KEY: {{ .Values.providers.openai.apiKey | b64enc | quote }}
  {{- else }}
  PICOCLAW_PROVIDERS_OPENAI_API_KEY: ""
  {{- end }}
  {{- if and .Values.providers .Values.providers.gemini .Values.providers.gemini.apiKey }}
  PICOCLAW_PROVIDERS_GEMINI_API_KEY: {{ .Values.providers.gemini.apiKey | b64enc | quote }}
  {{- else }}
  PICOCLAW_PROVIDERS_GEMINI_API_KEY: ""
  {{- end }}
  {{- if and .Values.providers .Values.providers.groq .Values.providers.groq.apiKey }}
  PICOCLAW_PROVIDERS_GROQ_API_KEY: {{ .Values.providers.groq.apiKey | b64enc | quote }}
  {{- else }}
  PICOCLAW_PROVIDERS_GROQ_API_KEY: ""
  {{- end }}
  
  {{- /* Tools */ -}}
  {{- if and .Values.tools .Values.tools.web .Values.tools.web.brave .Values.tools.web.brave.apiKey }}
  PICOCLAW_TOOLS_WEB_BRAVE_API_KEY: {{ .Values.tools.web.brave.apiKey | b64enc | quote }}
  {{- else }}
  PICOCLAW_TOOLS_WEB_BRAVE_API_KEY: ""
  {{- end }}
  
  {{- /* Telegram */ -}}
  {{- if and .Values.channels .Values.channels.telegram .Values.channels.telegram.enabled }}
  PICOCLAW_CHANNELS_TELEGRAM_ENABLED: {{ "true" | b64enc | quote }}
  {{- end }}
  {{- if and .Values.channels .Values.channels.telegram .Values.channels.telegram.token }}
  PICOCLAW_CHANNELS_TELEGRAM_TOKEN: {{ .Values.channels.telegram.token | b64enc | quote }}
  {{- else }}
  PICOCLAW_CHANNELS_TELEGRAM_TOKEN: ""
  {{- end }}
  
  {{- /* Discord */ -}}
  {{- if and .Values.channels .Values.channels.discord .Values.channels.discord.enabled }}
  PICOCLAW_CHANNELS_DISCORD_ENABLED: {{ "true" | b64enc | quote }}
  {{- end }}
  {{- if and .Values.channels .Values.channels.discord .Values.channels.discord.token }}
  PICOCLAW_CHANNELS_DISCORD_TOKEN: {{ .Values.channels.discord.token | b64enc | quote }}
  {{- else }}
  PICOCLAW_CHANNELS_DISCORD_TOKEN: ""
  {{- end }}
  
  {{- /* QQ */ -}}
  {{- if and .Values.channels .Values.channels.qq .Values.channels.qq.enabled }}
  PICOCLAW_CHANNELS_QQ_ENABLED: {{ "true" | b64enc | quote }}
  {{- end }}
  {{- if and .Values.channels .Values.channels.qq .Values.channels.qq.appId }}
  PICOCLAW_CHANNELS_QQ_APP_ID: {{ .Values.channels.qq.appId | b64enc | quote }}
  {{- else }}
  PICOCLAW_CHANNELS_QQ_APP_ID: ""
  {{- end }}
  {{- if and .Values.channels .Values.channels.qq .Values.channels.qq.appSecret }}
  PICOCLAW_CHANNELS_QQ_APP_SECRET: {{ .Values.channels.qq.appSecret | b64enc | quote }}
  {{- else }}
  PICOCLAW_CHANNELS_QQ_APP_SECRET: ""
  {{- end }}
  
  {{- /* DingTalk */ -}}
  {{- if and .Values.channels .Values.channels.dingtalk .Values.channels.dingtalk.enabled }}
  PICOCLAW_CHANNELS_DINGTALK_ENABLED: {{ "true" | b64enc | quote }}
  {{- end }}
  {{- if and .Values.channels .Values.channels.dingtalk .Values.channels.dingtalk.clientId }}
  PICOCLAW_CHANNELS_DINGTALK_CLIENT_ID: {{ .Values.channels.dingtalk.clientId | b64enc | quote }}
  {{- else }}
  PICOCLAW_CHANNELS_DINGTALK_CLIENT_ID: ""
  {{- end }}
  {{- if and .Values.channels .Values.channels.dingtalk .Values.channels.dingtalk.clientSecret }}
  PICOCLAW_CHANNELS_DINGTALK_CLIENT_SECRET: {{ .Values.channels.dingtalk.clientSecret | b64enc | quote }}
  {{- else }}
  PICOCLAW_CHANNELS_DINGTALK_CLIENT_SECRET: ""
  {{- end }}
  
  {{- /* LINE */ -}}
  {{- if and .Values.channels .Values.channels.line .Values.channels.line.enabled }}
  PICOCLAW_CHANNELS_LINE_ENABLED: {{ "true" | b64enc | quote }}
  {{- end }}
  {{- if and .Values.channels .Values.channels.line .Values.channels.line.channelSecret }}
  PICOCLAW_CHANNELS_LINE_CHANNEL_SECRET: {{ .Values.channels.line.channelSecret | b64enc | quote }}
  {{- else }}
  PICOCLAW_CHANNELS_LINE_CHANNEL_SECRET: ""
  {{- end }}
  {{- if and .Values.channels .Values.channels.line .Values.channels.line.channelAccessToken }}
  PICOCLAW_CHANNELS_LINE_CHANNEL_ACCESS_TOKEN: {{ .Values.channels.line.channelAccessToken | b64enc | quote }}
  {{- else }}
  PICOCLAW_CHANNELS_LINE_CHANNEL_ACCESS_TOKEN: ""
  {{- end }}
{{- end }}
